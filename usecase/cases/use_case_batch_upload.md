# 批量解析压缩包上传文献用例

| 项目 | 内容 |
|------|------|
| 用例名称 | 批量解析压缩包上传文献 |
| 简要描述 | 支持解析压缩包层级，创建文献实体分类，批量上传文献至指定分类下，<span style="color: red">并支持后台任务处理</span> |
| 参与者 | 普通用户 |
| 相关用例 | - 管理文献标签<br><span style="color: red">- 管理后台任务</span> |
| 前置条件 | 1. 按照文献分类组织文件夹路径<br>2. 添加文献标签（标签名、默认提示词）<br><span style="color: red">3. 用户已登录系统</span> |
| 后置条件 | 1. 所有文献上传成功<br><span style="color: red">2. 后台任务状态更新完成</span> |
| 基本事件流 | <span style="color: red">1. 用户通过以下任一方式进入批量上传界面：<br>   - 点击"文献管理"界面的"批量上传"按钮<br>   - 点击已有文献实体分类的"批量上传"按钮</span><br>2. 系统显示批量上传对话框（B-1）<br>3. 用户选择并上传压缩包<br>4. 系统解析压缩包路径（B-2）<br><span style="color: red">5. 系统显示解析结果预览，包含：<br>   - 将要创建的文献实体分类<br>   - 使用的文献标签<br>   - 待上传的文献数量<br>6. 用户确认上传<br>7. 系统创建后台批量上传任务<br>8. 系统在后台执行以下步骤：</span><br>   - 根据文件路径创建文献实体分类（A-1）<br>   - 系统查找文献标签（A-2）<br>   - 系统执行上传文献（D-1）（重复该步骤）<br><span style="color: red">9. 系统更新任务状态和进度<br>10. 用户可在"后台任务"界面查看任务进度<br>11. 任务完成后系统发送通知</span> |
| 备选事件流 | **A-* 中断上传**<br><span style="color: red">- 用户在确认上传前可以取消操作<br>- 用户在后台任务执行过程中可以终止任务</span><br><br>**A-1 分类已存在**<br>不用创建，直接关联该分类<br><br>**A-2 文献标签不存在**<br><span style="color: red">系统中断上传任务，在后台任务中标记失败，</span>提示用户"文献标签未创建，文献标签名需与文件夹名一致，请创建后重新上传压缩包" |
| 补充约束-数据需求 | **D-1 文献字段包含：**<br>- 文献pdf地址<br>- 文献名<br>- 文献标签<br>- 文献实体分类<br>- 创建时间<br>- 创建人<br>- 更新时间<br>- 更新人<br><br><span style="color: red">**D-2 后台任务字段包含：**<br>- 任务类型（批量上传）<br>- 任务状态（等待中/进行中/已完成/已失败）<br>- 任务进度<br>- 创建时间<br>- 完成时间<br>- 失败原因（如有）</span> |
| 补充约束-业务规则 | **B-* 压缩包文件层级说明**<br>假设压缩包有以下层级：<br>药材>白芍>主成分与药理作用>文献1/文献2/文献3<br>- 药材和白芍为文献实体分类<br>- 主成分与药理作用为文献标签<br><br>**B-1** 压缩包仅支持zip格式<br><br>**B-2** 文件夹路径中最后一个文件夹为文献标签，之前的所有文件夹为文献实体分类<br><br><span style="color: red">**B-3 后台任务处理规则：**<br>- 单个批量上传任务最大支持1000个文献<br>- 系统同时最多处理5个批量上传任务<br>- 超过限制的任务将进入等待队列</span> |
| 待解决问题 | <span style="color: red">1. 是否需要支持任务优先级设置<br>2. 是否需要支持批量任务的暂停/继续功能<br>3. 失败任务的重试机制设计</span> |
| 相关图 | <span style="color: red">建议添加以下流程图：<br>1. 批量上传整体流程图<br>2. 后台任务状态转换图<br>3. 用户界面交互图</span> | 