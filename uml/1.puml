@startuml

skinparam rectangle {
    BorderColor #555555
    BackgroundColor #EEEEEE
    ArrowColor #555555
}
skinparam actor {
    BorderColor #555555
    BackgroundColor #EEEEEE
    ArrowColor #555555
}
skinparam node {
    BorderColor #555555
    BackgroundColor #FFFFFF
    ArrowColor #555555
}
skinparam database {
    BorderColor #555555
    BackgroundColor #FFFFFF
    ArrowColor #555555
}

skinparam stereotype {
    CBackgroundColor #f66
    NBackgroundColor #f9f
    AgaBackgroundColor #ccf
    DbMasterBackgroundColor #FFD700
    DbReplicaBackgroundColor #E6E6FA
}

actor "é¡¾å®¢A" as User1
actor "é¡¾å®¢B" as User2

node "ğŸš æ™ºèƒ½è°ƒåº¦æ— äººæœº\n(æŒ‰ä½ç½®/å¥åº·çŠ¶å†µå¯¼èˆª)" as GeoDNS <<N>>

frame "åŸå¸‚å•†ä¸šåŒº (Region)" {
    package "ä¸œåŸåº— (Availability Zone A)" {
        rectangle "ğŸ‘¨â€ğŸ’¼ å…¨èƒ½æ€»ç®¡ (APIç½‘å…³)\n- èº«ä»½éªŒè¯\n- æµé‡æ§åˆ¶\n- è®¢å•è½¬å‘" as APG_A <<Aga>>
        rectangle "ğŸ‘‹ è¿å®¾å‘˜ (è´Ÿè½½å‡è¡¡å™¨)" as LB_A

        package "åå¨A (Backend Services)" {
            rectangle "ğŸ“‹ å®æ—¶å‘˜å·¥é€šè®¯å½•\n(æœåŠ¡æ³¨å†Œä¸å‘ç°)" as SR_A
            rectangle "ğŸ“Œ å¤§å‹è®¢å•å¤„ç†å° (é˜Ÿåˆ—)" as MQ_A
            rectangle "ğŸ‘¨â€ğŸ³ åå°ä¸“èŒå¨å¸ˆ (å¼‚æ­¥å¤„ç†)" as Worker_A
            
            package "æ±‰å ¡ç«™A (æœåŠ¡A)" {
                rectangle "å¨å¸ˆA1" as Burger_A1
                rectangle "å¨å¸ˆA2" as Burger_A2
            }
            package "è–¯æ¡ç«™A (æœåŠ¡B)" {
                rectangle "ğŸš¨ æ™ºèƒ½ç»ç† (ç†”æ–­å™¨)" as CB_A <<C>>
                rectangle "ç‚¸ç‚‰A" as Fries_A
            }
            database "ğŸ”¥ é£Ÿç‰©ä¿æ¸©å° (ç¼“å­˜)" as Cache_A
        }
        database "ğŸ‘‘ å¨å¸ˆé•¿ (ä¸»æ•°æ®åº“)" as DB_Master <<DbMaster>>
    }

    package "è¥¿åŸåº— (Availability Zone B)" {
        rectangle "ğŸ‘¨â€ğŸ’¼ å…¨èƒ½æ€»ç®¡ (APIç½‘å…³)" as APG_B <<Aga>>
        rectangle "ğŸ‘‹ è¿å®¾å‘˜ (è´Ÿè½½å‡è¡¡å™¨)" as LB_B
        package "åå¨B (Backend Services)" {
             package "æ±‰å ¡ç«™B (æœåŠ¡A)" {
                rectangle "å¨å¸ˆB1" as Burger_B1
            }
            package "è–¯æ¡ç«™B (æœåŠ¡B)" {
                rectangle "ç‚¸ç‚‰B" as Fries_B
            }
             database "ğŸ”¥ é£Ÿç‰©ä¿æ¸©å° (ç¼“å­˜)" as Cache_B
        }
        database "ğŸ‘¨â€ğŸ“ å­¦å¾’ (ä»æ•°æ®åº“)" as DB_Replica <<DbReplica>>
    }
}

' --- Connections ---
User1 --> GeoDNS
User2 --> GeoDNS
GeoDNS --> APG_A : å¯¼èˆªåˆ°ä¸œåŸåº—(ä¼˜é€‰)
GeoDNS ..> APG_B : <color:red>ä¸œåŸåº—æ•…éšœæ—¶, åˆ‡æ¢

APG_A --> LB_A
LB_A --> Burger_A1
LB_A --> Fries_A
Fries_A --[#red]> CB_A : æ•…éšœæŠ¥å‘Š
CB_A --[#red]> LB_A : æš‚åœæŒ‡ä»¤

Burger_A1 .> SR_A : ç™»è®°/æŸ¥è¯¢
Fries_A .> SR_A : ç™»è®°/æŸ¥è¯¢

APG_A --> MQ_A : å¤§è®¢å•
MQ_A ..> Worker_A : é€šçŸ¥å¤„ç†

DB_Master -> DB_Replica : å®æ—¶åŒæ­¥èœè°±

APG_B --> LB_B
LB_B --> Burger_B1
LB_B --> Fries_B
@enduml